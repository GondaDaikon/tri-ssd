---
description: Tri-SSDドキュメントのAIレビューを実行する
argument-hint: <ファイルパス|ID> - レビュー対象（必須）
allowed-tools: Read, Edit, Glob, Grep
---

# Tri-SSD レビューコマンド

<tri_ssd_context>
Tri-SSD（Tri-Layer Slice Spec Driven）はAI/LLMコードエージェントを前提とした仕様駆動開発。

レイヤー構造:
- L1: ビジョン・要求（docs/l1_vision.md）
- L2: 技術基盤（docs/l2_system/）- foundation.md, phases.md, rules.md
- L3: 機能仕様（docs/l3_features/F-xxx.md）

ID形式: PREFIX-YYYYMMDD-nnn（REQ, PH, F, NF）
ステータス: draft → reviewed → implemented（L3のみ）
</tri_ssd_context>

## レビュー時の原則

<avoid_over_engineering>
- 重箱の隅をつつかない（本質的な問題に集中）
- 「あった方がよい」程度の改善は指摘しない
- ドキュメントの複雑さが機能の複雑さに見合っているか確認
- 単純な機能に対して「セクションが足りない」と指摘しない
</avoid_over_engineering>

## 引数

- `$1`: レビュー対象（必須）
  - ファイルパス: 直接指定
  - ID: REQ-xxx, F-xxx 等で指定

## 前提処理

1. `$1` で指定された対象ファイルを特定・読み込む

## レビュー観点

<thinking_process>
各観点をチェックする前に、以下を判断する：

1. **このドキュメントの目的は何か？**（L1/L2/L3 で求められるものが異なる）
2. **機能の複雑さに対して適切な詳細度か？**
3. **致命的な問題 vs あれば良い改善 を区別する**（高優先度指摘は致命的な問題のみ）
</thinking_process>

### 共通
- [ ] フロントマター必須フィールドの存在
- [ ] タイトル見出しの存在（titleフィールドは廃止、`# 見出し`を使用）
- [ ] TODO/プレースホルダーの残存確認

### L1（ビジョン・要求）
- [ ] プロダクト目的が明確か
- [ ] ペルソナが具体的か
- [ ] 機能要求に優先度があるか
- [ ] 非機能要求が定義されているか

### L2（機能設計・技術方針）
- [ ] 技術選定の根拠があるか
- [ ] フェーズのExit Criteriaが明確か
- [ ] 機能の依存関係が整理されているか
- [ ] NFRカタログが十分か

### L3（機能ドキュメント）
- [ ] 入出力が明確か
- [ ] 受け入れ条件がテスト可能か
- [ ] タスクチェックリストが実装可能な粒度か

### 定量的指標（規模の目安）

#### L1
| 項目 | 目安 | 規模感 |
|------|------|--------|
| REQ数 | 5-50個 | 小規模〜大規模 |

#### L2
| 項目 | 目安 | 規模感 |
|------|------|--------|
| フェーズ数 | 2-8個 | 小規模〜大規模 |
| 機能数 | 10-100個 | 小規模〜大規模 |

## 出力形式

```markdown
# レビュー結果

**ファイル**: docs/l3_features/F-20250125-001_xxx.md
**評価**: B（改善推奨）

## 良い点
- ...

## 改善点
1. [優先度:高] ...
2. [優先度:中] ...

## 推奨アクション
- ...

## 昇格判定
**昇格可能**: Yes / No（条件未達の場合は理由）
```

## ステータス昇格機能

レビュー結果が良好な場合、doc_status の昇格を提案する。

### 状態遷移

| 現在 | 昇格後 | 対象 |
|------|--------|------|
| draft | reviewed | L1, L2, L3 |
| reviewed | implemented | L3のみ |

### 昇格条件

**draft → reviewed:**
- 必須フィールドが存在
- 参照整合性が保たれている
- 致命的な問題がない

**reviewed → implemented（L3のみ）:**
- タスクチェックリストが完了
- 実装メモにコードパスが記載

### 昇格フロー

1. レビュー結果を出力
2. 昇格可能な場合：「昇格しますか？ (yes/no)」と確認
3. yes の場合：doc_status を更新
