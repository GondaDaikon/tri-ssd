---
id: F-YYYYMMDD-nnn
kind: feature
layer: L3
status: active
doc_status: draft
req_ids:
  - REQ-YYYYMMDD-nnn
nfr_ids:
  - NF-YYYYMMDD-nnn
phase: PH-YYYYMMDD-nnn
---

# [機能名]

> **ドメイン**: Mobileアプリケーション
> **テンプレートバージョン**: v2.0

## 1. 概要

### 1.1 この機能でできること

[この機能でユーザーが何をできるようになるか、1〜3文で説明]

### 1.2 代表的なユースケース

**ユースケース1**: [シナリオ名]
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

**ユースケース2**: [シナリオ名]
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

---

## 2. 画面設計

### 2.1 画面仕様

| 項目 | 仕様 |
|------|------|
| 画面名 | [画面名] |
| 画面ID | `[screen-id]` |
| 遷移元 | [画面名] |
| 遷移先 | [画面名1], [画面名2] |
| タブバー表示 | あり / なし |
| 戻るボタン | あり / なし |

### 2.2 画面レイアウト

#### 縦画面（Portrait）

```
┌─────────────────────────────────┐
│  [ステータスバー]                  │ 44pt (iOS) / 24dp (Android)
├─────────────────────────────────┤
│  [ナビゲーションバー]               │ 56pt (iOS) / 56dp (Android)
│  ← [タイトル]        [アクション]  │
├─────────────────────────────────┤
│                                 │
│  [コンテンツエリア]                │
│  ┌─────────────────────────┐   │
│  │  [セクション1]            │   │
│  │  ・要素1                 │   │
│  │  ・要素2                 │   │
│  └─────────────────────────┘   │
│  ┌─────────────────────────┐   │
│  │  [セクション2]            │   │
│  └─────────────────────────┘   │
│                                 │
│  [ボタン: アクション]             │
│                                 │
├─────────────────────────────────┤
│  [タブバー]                       │ 49pt (iOS) / 56dp (Android)
│  [Tab1] [Tab2] [Tab3] [Tab4]    │
└─────────────────────────────────┘
```

#### 横画面（Landscape）

```
┌─────────────────────────────────────────────┐
│  [ナビゲーション]  [コンテンツエリア]          │
│  ← [タイトル]      ┌───────────────────┐   │
│                   │                   │   │
│  [サイドメニュー]   │  [メインコンテンツ] │   │
│  ・項目1          │                   │   │
│  ・項目2          │                   │   │
│                   └───────────────────┘   │
└─────────────────────────────────────────────┘
```

### 2.3 画面遷移

```
[ホーム画面]
    │
    ├─> [画面A] ─────> [画面A-1]
    │      │
    │      └─────> [画面A-2]
    │
    ├─> [画面B] ─────> [画面B-1]
    │                     │
    │                     └─> [画面B-2]
    │
    └─> [設定画面]
```

**遷移アニメーション**:
- iOS: スライド（右から左）、モーダル（下から上）
- Android: フェード、スライド

### 2.4 ジェスチャー

| ジェスチャー | 動作 | プラットフォーム |
|------------|------|----------------|
| スワイプ（左） | [動作] | iOS / Android |
| スワイプ（右） | 戻る | iOS / Android |
| ロングタップ | [動作] | iOS / Android |
| ピンチイン/アウト | [動作] | iOS / Android |
| ダブルタップ | [動作] | iOS / Android |

### 2.5 UIコンポーネント

| コンポーネント | iOS | Android | 説明 |
|--------------|-----|---------|------|
| [コンポーネント1] | UIKit/SwiftUI | Material Design | [説明] |
| [コンポーネント2] | [iOS実装] | [Android実装] | [説明] |

---

## 3. デバイス機能統合

### 3.1 カメラ

| 機能 | 用途 | 権限 |
|------|------|------|
| 写真撮影 | [用途] | Camera |
| ビデオ撮影 | [用途] | Camera, Microphone |
| QRコードスキャン | [用途] | Camera |

**権限リクエスト文言**:
- iOS: "プロフィール写真を撮影するためにカメラへのアクセスが必要です"
- Android: 同上

### 3.2 位置情報

| 機能 | 精度 | 権限 | バッテリー影響 |
|------|------|------|--------------|
| 現在地取得 | 高精度 | Location (Always/When In Use) | 中 |
| ジオフェンシング | 低精度 | Location (Always) | 低 |

**権限リクエスト文言**:
- iOS: "近くの店舗を表示するために位置情報へのアクセスが必要です"
- Android: 同上

### 3.3 プッシュ通知

| 通知種類 | トリガー | 優先度 | 動作 |
|---------|---------|--------|------|
| [通知1] | [トリガー] | High | [動作] |
| [通知2] | [トリガー] | Low | [動作] |

**通知設定**:
- サウンド: あり / なし
- バイブレーション: あり / なし
- バッジ: あり / なし

### 3.4 生体認証

| 認証方式 | iOS | Android |
|---------|-----|---------|
| 指紋認証 | Touch ID | Fingerprint |
| 顔認証 | Face ID | Face Unlock |

**フォールバック**: パスコード / PIN

### 3.5 その他のデバイス機能

| 機能 | 用途 | プラットフォーム |
|------|------|----------------|
| 連絡先 | [用途] | iOS / Android |
| フォトライブラリ | [用途] | iOS / Android |
| マイク | [用途] | iOS / Android |
| Bluetooth | [用途] | iOS / Android |
| NFC | [用途] | iOS / Android |

---

## 4. オフライン・同期

### 4.1 ローカルストレージ

| データ種類 | ストレージ | 容量 |
|-----------|-----------|------|
| 設定データ | UserDefaults / SharedPreferences | 〜1MB |
| キャッシュデータ | File System | 〜100MB |
| データベース | SQLite / Realm / CoreData | 〜500MB |

### 4.2 オフライン対応

| 機能 | オフライン動作 | 同期タイミング |
|------|--------------|--------------|
| [機能1] | 可能 | オンライン復帰時 |
| [機能2] | 不可（エラー表示） | - |
| [機能3] | 読取のみ可能 | バックグラウンド同期 |

### 4.3 同期戦略

```
ローカルDB <────> 同期エンジン <────> サーバーAPI
              │
              └─> 競合解決ロジック
```

**競合解決**:
- サーバー優先 / クライアント優先 / タイムスタンプ比較

---

## 5. 業務ルール・例外

### 5.1 バリデーションルール

| 項目 | ルール | エラーメッセージ | 表示方法 |
|------|--------|-----------------|---------|
| [項目名1] | 必須 | "[項目名]は必須です" | インライン |
| [項目名2] | 最大100文字 | "100文字以内で入力してください" | インライン |

### 5.2 状態管理

```
[初期状態] ─────> [ローディング] ─────> [データ表示]
                                          │
                                          ├─> [更新中]
                                          │     │
                                          │     └─> [完了]
                                          │
                                          └─> [エラー]
                                                │
                                                └─> [リトライ]
```

### 5.3 ネットワークエラー処理

| エラー種類 | 表示 | リトライ |
|-----------|------|---------|
| タイムアウト | "通信がタイムアウトしました" | 手動 |
| ネットワーク未接続 | "インターネット接続を確認してください" | 自動 |
| サーバーエラー | "サーバーエラーが発生しました" | 手動 |

---

## 6. タスクチェックリスト

### 6.1 実装タスク

#### 画面実装

- [ ] 画面コンポーネント実装（iOS: SwiftUI/UIKit）
- [ ] 画面コンポーネント実装（Android: Jetpack Compose/XML）
- [ ] ナビゲーション実装
- [ ] 画面遷移アニメーション
- [ ] ジェスチャー実装

#### デバイス機能

- [ ] カメラ統合
- [ ] 位置情報統合
- [ ] プッシュ通知実装
- [ ] 生体認証実装
- [ ] 権限リクエスト実装

#### データ管理

- [ ] ローカルストレージ実装
- [ ] オフライン対応
- [ ] 同期エンジン実装
- [ ] キャッシュ管理

#### ネットワーク

- [ ] APIクライアント実装
- [ ] エラーハンドリング
- [ ] リトライロジック

#### その他

- [ ] ログ出力実装
- [ ] アナリティクス実装
- [ ] クラッシュレポート実装

### 6.2 テストタスク

#### ユニットテスト

- [ ] ビジネスロジックテスト
- [ ] データ処理テスト
- [ ] バリデーションテスト

#### UI テスト

- [ ] 画面表示テスト（XCTest / Espresso）
- [ ] 画面遷移テスト
- [ ] ジェスチャーテスト

#### 統合テスト

- [ ] API統合テスト
- [ ] デバイス機能統合テスト
- [ ] オフライン・同期テスト

#### デバイステスト

- [ ] 実機テスト（iOS: 各世代のiPhone/iPad）
- [ ] 実機テスト（Android: 各メーカー・画面サイズ）
- [ ] シミュレータ/エミュレータテスト

---

## 7. 非機能・受け入れ条件

### 7.1 非機能要求の具体化

| NF ID | 要求 | この機能での具体化 |
|-------|------|-------------------|
| NF-YYYYMMDD-nnn | 起動時間 | 3秒以内（コールドスタート） |
| NF-YYYYMMDD-nnn | メモリ使用量 | 200MB以内 |
| NF-YYYYMMDD-nnn | バッテリー消費 | 1時間使用で10%以内 |
| NF-YYYYMMDD-nnn | オフライン動作 | 主要機能はオフライン利用可能 |

### 7.2 受け入れ条件

#### AC-1: [条件名]

```gherkin
Given [前提条件]
When [操作・アクション]
Then [期待される結果]
```

#### AC-2: [条件名]

```gherkin
Given [前提条件]
When [操作・アクション]
Then [期待される結果]
```

### 7.3 パフォーマンス基準

| メトリクス | 目標値 | 測定方法 |
|-----------|--------|---------|
| 起動時間（コールド） | 3秒以内 | Xcode Instruments / Android Profiler |
| 起動時間（ホット） | 1秒以内 | 同上 |
| 画面遷移時間 | 300ms以内 | 手動計測 |
| API レスポンス | 2秒以内 | Charles Proxy |
| メモリ使用量 | 200MB以内 | Xcode Instruments / Android Profiler |
| バッテリー消費 | 10%/時間以内 | Battery testing |

---

## 8. 実装メモ・注意点

### 8.1 適用した設計パターン

- **[パターン名1]**: [適用理由・概要]
- **[パターン名2]**: [適用理由・概要]

### 8.2 関連コードへのリンク

#### iOS

| 種別 | パス |
|------|------|
| View | `ios/[AppName]/Views/[FeatureName]/` |
| ViewModel | `ios/[AppName]/ViewModels/[FeatureName]/` |
| Model | `ios/[AppName]/Models/` |
| Service | `ios/[AppName]/Services/` |
| Tests | `ios/[AppName]Tests/[FeatureName]/` |

#### Android

| 種別 | パス |
|------|------|
| Activity/Fragment | `android/app/src/main/java/.../ui/[feature]/` |
| ViewModel | `android/app/src/main/java/.../viewmodel/` |
| Repository | `android/app/src/main/java/.../repository/` |
| Model | `android/app/src/main/java/.../model/` |
| Tests | `android/app/src/test/java/.../ [feature]/` |

### 8.3 技術的負債・暫定対応

- [ ] [負債1：何が暫定で、どう直すべきか]
- [ ] [負債2]

### 8.4 注意点・申し送り事項

- [注意点1]
- [注意点2]

### 8.5 Mobile固有の考慮事項

#### プラットフォーム固有の挙動

| 機能 | iOS | Android |
|------|-----|---------|
| 戻るボタン | ナビゲーションバーの「<」 | システム戻るボタン |
| 通知 | 通知センター | 通知ドロワー |
| 権限 | 初回使用時リクエスト | インストール時/初回使用時 |

#### 画面サイズ対応

| デバイス | 解像度 | 対応 |
|---------|-------|------|
| iPhone SE | 375x667 | ✓ |
| iPhone 14 | 390x844 | ✓ |
| iPhone 14 Pro Max | 430x932 | ✓ |
| iPad | 1024x768 | ✓ / △ / × |
| Android Small | 320dp | ✓ |
| Android Medium | 360dp | ✓ |
| Android Large | 480dp | ✓ |
| Android Tablet | 600dp+ | ✓ / △ / × |

#### ダークモード対応

- [ ] ライトモード
- [ ] ダークモード
- [ ] システム設定に従う

---

## 9. ストア申請

### 9.1 App Store（iOS）

#### アプリ情報

- **カテゴリ**: [カテゴリ]
- **年齢制限**: 4+ / 9+ / 12+ / 17+
- **価格**: 無料 / 有料

#### 審査準備

- [ ] スクリーンショット（全サイズ）
- [ ] App Preview動画
- [ ] アプリ説明文
- [ ] キーワード
- [ ] プライバシーポリシーURL
- [ ] サポートURL
- [ ] テストアカウント（必要な場合）

#### 審査ガイドライン確認

- [ ] App Store Review Guidelines 準拠
- [ ] Human Interface Guidelines 準拠
- [ ] プライバシー要件
- [ ] 広告識別子使用（該当する場合）

### 9.2 Google Play（Android）

#### アプリ情報

- **カテゴリ**: [カテゴリ]
- **コンテンツレーティング**: [レーティング]
- **価格**: 無料 / 有料

#### 審査準備

- [ ] スクリーンショット（Phone, 7-inch, 10-inch）
- [ ] 動画（YouTube）
- [ ] アプリ説明文（短い/長い）
- [ ] プライバシーポリシーURL
- [ ] アプリへのアクセス権限の説明

#### ポリシー確認

- [ ] Google Play Policy 準拠
- [ ] Material Design Guidelines（推奨）
- [ ] データセーフティセクション記入
- [ ] 広告ID使用（該当する場合）

---

## 10. アナリティクス・監視

### 10.1 トラッキングイベント

| イベント名 | パラメータ | トリガー |
|-----------|-----------|---------|
| screen_view | screen_name | 画面表示時 |
| [event_1] | [param] | [トリガー] |
| [event_2] | [param] | [トリガー] |

### 10.2 クラッシュレポート

- **ツール**: Firebase Crashlytics / Sentry / etc
- **収集情報**: スタックトレース、デバイス情報、OS version
- **プライバシー**: 個人情報の除外

### 10.3 パフォーマンス監視

| メトリクス | ツール |
|-----------|-------|
| 起動時間 | Firebase Performance / New Relic |
| ネットワークレイテンシ | Firebase Performance |
| 画面レンダリング | Xcode Instruments / Android Profiler |
| メモリリーク | Xcode Instruments / LeakCanary |
