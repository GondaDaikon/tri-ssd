---
description: SSDDドキュメントのAIレビューを実行する
argument-hint: <ファイルパス|ID> - レビュー対象（必須）
allowed-tools: Read, Glob, Grep
---

# AI レビューコマンド

## 引数

- `$1`: レビュー対象（必須）
  - ファイルパス: 直接ファイルを指定
  - ID: REQ-xxxx, F-xxxx, PH-xxxx 等の ID で指定

## エラー処理

### 引数がない場合

```
エラー: レビュー対象を指定してください。
使用方法: /review <ファイルパス|ID>
例:
  /review docs/l1_vision/vision.md
  /review F-0001
  /review REQ-0001
```

### 指定されたファイルが存在しない場合

```
エラー: 指定されたファイルが見つかりません: [ファイルパス]
ファイルパスを確認してください。
```

### 指定された ID が見つからない場合

```
エラー: 指定された ID のドキュメントが見つかりません: [ID]
docs/ 配下を検索しましたが、該当するドキュメントがありません。

ヒント:
- /check --list-ids で存在する ID 一覧を確認できます
- ID の形式を確認してください（例: F-0001, REQ-0001, PH-0001）
```

### テンプレートが存在しない場合

```
警告: テンプレートが見つからないため、構造レビューをスキップします。
必要なファイル: docs/templates/[該当テンプレート].md
```

## 前提処理

1. `.claude/skills/ssdd.md` を読み込み、SSDD の基本概念を把握する
2. `docs/templates/README.md` を読み込み、フロントマター仕様を確認する
3. 対象のレイヤに応じたテンプレートを読み込む:
   - L1: `docs/templates/l1_vision.md`
   - L2: `docs/templates/l2_overview.md`, `docs/templates/l2_phases.md`
   - L3: `docs/templates/l3_feature.md`
4. `$1` で指定された対象ファイルを特定・読み込む

## ID からファイル特定

`$1` が ID 形式の場合：

1. `docs/` 配下の全 `.md` ファイルを検索
2. フロントマターの `id` フィールドが一致するファイルを特定
3. 見つからない場合はエラー

## レビュー観点

### 1. フロントマター検証

- 必須フィールドの存在と妥当性
- 参照フィールドの整合性

### 2. 構造レビュー

- テンプレートに沿った構成になっているか
- 必須セクションが存在するか
- 各セクションの内容が適切か

### 3. 内容レビュー（レイヤ別）

#### L1 レビュー観点

- [ ] 技術詳細が混入していないか（L2相当の内容）
- [ ] 要件が REQ-xxxx で ID 管理されているか
- [ ] ペルソナ・ユースケースが具体的か
- [ ] 非機能要求が高レベルで記載されているか

#### L2 レビュー観点

- [ ] L1 の REQ が漏れなくカバーされているか
- [ ] 機能分解の粒度が適切か
- [ ] フェーズ設計が「結合して意味がある」単位か
- [ ] 技術選定の理由が明記されているか
- [ ] 依存関係が明確か

#### L3 レビュー観点

- [ ] L2 の機能定義と整合しているか
- [ ] 受け入れ条件が具体的か（Given-When-Then）
- [ ] タスクチェックリストが実装可能な粒度か
- [ ] 非機能要求の具体化が十分か

### 4. TODO チェック

- `<!-- TODO: 要確認 -->` の残存箇所を指摘

### 5. 上位層との整合性

- L3 の場合: L2 の定義との整合性
- L2 の場合: L1 の要求との整合性

## 出力形式

```
## レビュー結果: [ファイル名]

### サマリ
- レイヤ: [L1|L2|L3]
- ID: [ID]
- doc_status: [status]

### 指摘事項

#### 重要（修正推奨）
1. [指摘内容]
   - 該当箇所: [セクション名/行番号]
   - 修正案: [具体的な修正案]

#### 軽微（検討推奨）
1. [指摘内容]
   - 該当箇所: [セクション名/行番号]
   - 提案: [改善提案]

### TODO 残存
- [行番号]: [TODO内容]

### 良い点
- [評価ポイント]

### 総評
[全体的な評価とネクストアクションの提案]
```

## 完了後の案内

- 指摘事項がある場合: 修正の優先順位を提案
- `doc_status: draft` の場合: `reviewed` への変更条件を説明
- 整合性問題がある場合: `/check` での確認を推奨
