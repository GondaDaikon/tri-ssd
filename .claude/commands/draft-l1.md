---
description: 対話形式でL1（ビジョン・要求）ドキュメントを作成する
argument-hint: なし
allowed-tools: Read, Write, Edit
---

# L1 ドラフト作成コマンド

## 前提処理

1. `.claude/skills/ssdd.md` を読み込み、SSDD の基本概念を把握する
2. `docs/templates/l1_vision.md` を読み込み、L1 テンプレートを確認する
3. `docs/templates/README.md` を読み込み、フロントマター仕様を確認する

## エラー処理

### テンプレートが存在しない場合

```
エラー: L1 テンプレートが見つかりません。
必要なファイル: docs/templates/l1_vision.md
先に /init-ssdd を実行するか、テンプレートを配置してください。
```

### 出力先ディレクトリが存在しない場合

```
エラー: 出力先ディレクトリが存在しません。
必要なディレクトリ: docs/
先に /init-ssdd を実行するか、手動で docs/ ディレクトリを作成してください。
```

### 既存ファイルがある場合

`docs/l1_vision.md` が既に存在する場合、ユーザーに確認：

```
警告: docs/l1_vision.md は既に存在します。
以下から選択してください:
1. 上書き（既存内容は失われます）
2. 別名で保存（vision_new.md）
3. キャンセル
```

## 実行内容

ユーザーとの対話を通じて、L1（ビジョン・要求）ドキュメントを作成します。

## 対話フロー

### Step 1: プロダクト概要

以下を質問：

1. プロダクト名は何ですか？
2. このプロダクトで解決したい課題は何ですか？
3. 想定ユーザー（ペルソナ）は誰ですか？

### Step 2: 制約条件

以下を質問：

1. 対応する動作環境（OS、ブラウザ等）はありますか？
2. 法規制やコンプライアンス要件はありますか？
3. 連携が必要な外部システムはありますか？

### Step 3: 機能要求

以下を質問：

1. 実装したい主な機能を教えてください
2. 各機能の優先度（高/中/低）はどうですか？
3. 参考にしたい類似サービスはありますか？

### Step 4: 非機能要求

以下を質問：

1. 性能に関する要求はありますか？（レスポンス時間等）
2. セキュリティ要件はありますか？
3. その他の品質要求はありますか？

## 出力仕様

- **ファイルパス**: `docs/l1_vision.md`
- **フロントマター**: `doc_status: draft` で開始
- **曖昧箇所**: `<!-- TODO: 要確認 -->` でマーク
- **REQ ID**: 自動採番（タイムスタンプベース: REQ-YYYYMMDD-nnn）

### ID採番ロジック

```markdown
# REQ ID採番アルゴリズム

1. 現在日時を取得: YYYYMMDD = "20250125"
2. 既存のREQ IDを検索:
   - Grepで docs/**/*.md から `REQ-{YYYYMMDD}-` で始まるIDを抽出
3. 同日のREQ IDがある場合:
   - 最大連番を取得: max_num = 002
   - 次の連番を計算: next_num = 003
   - 新ID: REQ-20250125-003
4. 同日のREQ IDがない場合:
   - 新ID: REQ-20250125-001

例:
- 2025年1月25日の最初のREQ: REQ-20250125-001
- 2025年1月25日の2番目のREQ: REQ-20250125-002
- 2025年1月26日の最初のREQ: REQ-20250126-001
```

## テンプレート適用

`docs/templates/l1_vision.md` の構造に従い、対話で得た情報を埋める。
情報が不足している箇所は `<!-- TODO: 要確認 -->` でマークする。

## 完了後の案内

- 作成したファイルのパスを報告
- `/gen-l2` で L2 を生成できることを案内
- `doc_status` を `reviewed` に変更するタイミングを説明
