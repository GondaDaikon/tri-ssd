# SSDD プロンプト品質評価システム

SSDDプラグインのプロンプト（`/gen-l3` 等）の出力品質を評価するためのローカルテスト環境。

## 概要

```
1. テストケース（固定のL1/L2）を使って gen-l3 を実行
2. 生成されたL3ドキュメントのメトリクスを算出
3. 基準値と比較して品質を評価
```

## ディレクトリ構成

```
eval/
├── README.md           # このファイル
├── package.json
├── metrics.js          # メトリクス算出スクリプト
├── test-cases/
│   └── simple-crud/    # テストケース: 単純CRUD機能
│       └── docs/       # L1/L2ドキュメント
└── outputs/            # 生成結果（gitignore）
```

## 使い方

### 1. L3を生成（Claude Code CLI）

```bash
cd eval/test-cases/simple-crud

# Claude Code でL3を生成
claude -p "/gen-l3 F-20251129-003"

# 生成されたファイルを outputs/ にコピー
cp docs/l3_features/F-*.md ../../outputs/
```

### 2. メトリクスを算出

```bash
cd eval

# メトリクス評価
node metrics.js outputs/F-20251129-003_note-delete.md

# 単純CRUD向け評価（不要セクションの警告あり）
node metrics.js outputs/F-20251129-003_note-delete.md --simple-crud

# JSON出力
node metrics.js outputs/F-20251129-003_note-delete.md --json
```

## 評価メトリクス

| メトリクス | 説明 | 基準 |
|-----------|------|------|
| AC数 | 受け入れ条件の数 | 2〜7 ✅ / 10+ ❌ |
| 空テーブル | プレースホルダーのみのテーブル行 | 0 ✅ |
| 曖昧表現 | 「適切に」「など」等 | 2以下 ✅ |
| 状態遷移 | 状態遷移セクションの有無 | 単純CRUD→なし ✅ |
| シーケンス図 | シーケンス図セクションの有無 | 単純CRUD→なし ✅ |

## テストケース

### simple-crud

**目的**: 単純なCRUD機能（メモ削除）に対して、過剰設計が発生しないことを確認

**評価対象機能**: F-20251129-003（メモ削除）

**期待する出力**:
- AC数: 3〜5個
- 状態遷移: なし
- シーケンス図: なし
- 空テーブル: 0

## 出力例

```
┌─────────────────────────────────────────────────┐
│  📊 SSDD L3 品質評価レポート                    │
├─────────────────────────────────────────────────┤
│  ファイル: F-20251129-003_note-delete.md        │
├─────────────────────────────────────────────────┤
│  ✅ AC数: 4 (OK)                                │
│  ✅ 空テーブル: 0 (OK)                          │
│  ✅ 曖昧表現: 1 (OK)                            │
├─────────────────────────────────────────────────┤
│  総合: ✅ PASS: 3, WARN: 0, FAIL: 0             │
└─────────────────────────────────────────────────┘
```

## 将来の拡張

- [ ] GitHub Actions での自動実行（Issue #664 解決後）
- [ ] gen-phases の評価追加
- [ ] LLM-as-a-Judge による定性評価
- [ ] 複数テストケース対応（workflow, api-only 等）
