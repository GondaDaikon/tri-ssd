---
id: F-YYYYMMDD-nnn
kind: feature
layer: L3
status: active
doc_status: draft
req_ids:
  - REQ-YYYYMMDD-nnn
nfr_ids:
  - NF-YYYYMMDD-nnn
phase: PH-YYYYMMDD-nnn
---

# [機能名]

> **ドメイン**: Desktopアプリケーション
> **テンプレートバージョン**: v2.0

## 1. 概要

### 1.1 この機能でできること

[この機能でユーザーが何をできるようになるか、1〜3文で説明]

### 1.2 代表的なユースケース

**ユースケース1**: [シナリオ名]
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

**ユースケース2**: [シナリオ名]
1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

---

## 2. ウィンドウ・UI設計

### 2.1 ウィンドウ仕様

| 項目 | 仕様 |
|------|------|
| ウィンドウタイプ | メインウィンドウ / モーダル / 非モーダル |
| デフォルトサイズ | 幅 x 高さ（px） |
| 最小サイズ | 幅 x 高さ（px） |
| 最大化 | 可能 / 不可 |
| リサイズ | 可能 / 不可 |
| デフォルト位置 | 中央 / 前回位置復元 |
| タイトルバー | あり / なし（カスタム） |

### 2.2 ウィンドウレイアウト

```
┌───────────────────────────────────────────────┐
│  [タイトルバー]                    [最小化][最大化][閉じる]│
├───────────────────────────────────────────────┤
│  [メニューバー]                                 │
│  ファイル  編集  表示  ツール  ヘルプ              │
├───────────────────────────────────────────────┤
│  [ツールバー]                                   │
│  [新規] [開く] [保存] | [元に戻す] [やり直し]      │
├──────────┬────────────────────────────────────┤
│          │  [メインコンテンツエリア]              │
│  [サイド  │  ┌────────────────────────┐       │
│   バー]   │  │  [コンテンツ]           │       │
│          │  │                        │       │
│          │  └────────────────────────┘       │
├──────────┴────────────────────────────────────┤
│  [ステータスバー]  [状態表示]  [進捗]             │
└───────────────────────────────────────────────┘
```

### 2.3 メニュー構成

#### メニューバー

**ファイル**
- 新規作成 (Ctrl+N / Cmd+N)
- 開く... (Ctrl+O / Cmd+O)
- 保存 (Ctrl+S / Cmd+S)
- 名前を付けて保存... (Ctrl+Shift+S / Cmd+Shift+S)
- ---
- 終了 (Alt+F4 / Cmd+Q)

**編集**
- 元に戻す (Ctrl+Z / Cmd+Z)
- やり直し (Ctrl+Y / Cmd+Shift+Z)
- ---
- 切り取り (Ctrl+X / Cmd+X)
- コピー (Ctrl+C / Cmd+C)
- 貼り付け (Ctrl+V / Cmd+V)

**[その他のメニュー]**
- [メニュー項目]

#### コンテキストメニュー

| トリガー | メニュー項目 |
|---------|-------------|
| [領域1]で右クリック | [項目1], [項目2], [項目3] |
| [領域2]で右クリック | [項目1], [項目2] |

#### キーボードショートカット

| 操作 | Windows | macOS |
|------|---------|-------|
| [操作1] | Ctrl+[Key] | Cmd+[Key] |
| [操作2] | Ctrl+Shift+[Key] | Cmd+Shift+[Key] |
| [操作3] | F[n] | F[n] |

### 2.4 ダイアログ

| ダイアログ名 | トリガー | 種類 | ボタン |
|------------|---------|------|--------|
| [ダイアログ1] | [トリガー] | モーダル | OK, キャンセル |
| [ダイアログ2] | [トリガー] | 非モーダル | 閉じる |

---

## 3. システム統合

### 3.1 ファイルシステム

#### ファイル操作

| 操作 | 対象 | 説明 |
|------|------|------|
| ファイルを開く | [拡張子] | [説明] |
| ファイルを保存 | [拡張子] | [説明] |
| ドラッグ&ドロップ | [対応形式] | [動作] |

#### ファイルパス

- **設定ファイル**:
  - Windows: `%APPDATA%/[app-name]/config.json`
  - macOS: `~/Library/Application Support/[app-name]/config.json`
  - Linux: `~/.config/[app-name]/config.json`

- **データファイル**:
  - Windows: `%LOCALAPPDATA%/[app-name]/data/`
  - macOS: `~/Library/Application Support/[app-name]/data/`
  - Linux: `~/.local/share/[app-name]/data/`

- **ログファイル**:
  - Windows: `%LOCALAPPDATA%/[app-name]/logs/`
  - macOS: `~/Library/Logs/[app-name]/`
  - Linux: `~/.local/share/[app-name]/logs/`

### 3.2 システムトレイ

| 項目 | 説明 |
|------|------|
| アイコン表示 | あり / なし |
| トレイメニュー | [メニュー項目1], [メニュー項目2] |
| 最小化時の動作 | トレイに格納 / タスクバーに表示 |
| 通知 | あり / なし |

### 3.3 OS通知

| イベント | 通知内容 | 優先度 |
|---------|---------|--------|
| [イベント1] | [通知メッセージ] | 高 / 中 / 低 |
| [イベント2] | [通知メッセージ] | 高 / 中 / 低 |

### 3.4 ネイティブAPI使用

| API | 用途 | プラットフォーム |
|-----|------|----------------|
| [API1] | [用途] | Windows / macOS / Linux |
| [API2] | [用途] | [プラットフォーム] |

---

## 4. 業務ルール・例外

### 4.1 バリデーションルール

| 項目 | ルール | エラーメッセージ |
|------|--------|-----------------|
| [項目名1] | [ルール] | [エラーメッセージ] |
| [項目名2] | [ルール] | [エラーメッセージ] |

### 4.2 状態遷移

```
[初期状態] ─────> [ファイル選択] ─────> [処理中]
                                          │
                                          ├─> [完了]
                                          │
                                          └─> [エラー]
```

### 4.3 例外的なケース

| ケース | 動作 |
|--------|------|
| ファイルが存在しない | [動作説明] |
| ファイルが使用中 | [動作説明] |
| ディスク容量不足 | [動作説明] |

---

## 5. タスクチェックリスト

### 5.1 実装タスク

#### ウィンドウ・UI

- [ ] メインウィンドウ実装
- [ ] メニューバー実装
- [ ] ツールバー実装
- [ ] ステータスバー実装
- [ ] ダイアログ実装
- [ ] キーボードショートカット実装
- [ ] コンテキストメニュー実装

#### システム統合

- [ ] ファイルシステム操作実装
- [ ] ドラッグ&ドロップ対応
- [ ] システムトレイ実装
- [ ] OS通知実装
- [ ] ネイティブAPI連携

#### データ管理

- [ ] ローカルストレージ実装
- [ ] 設定ファイル読み書き
- [ ] データファイル管理
- [ ] 自動保存機能

#### その他

- [ ] ログ出力実装
- [ ] エラーハンドリング
- [ ] 多言語対応（i18n）

### 5.2 テストタスク

#### ユニットテスト

- [ ] ビジネスロジックテスト
- [ ] データ処理テスト
- [ ] バリデーションテスト

#### UI テスト

- [ ] ウィンドウ操作テスト
- [ ] メニュー操作テスト
- [ ] キーボードショートカットテスト
- [ ] ドラッグ&ドロップテスト

#### 統合テスト

- [ ] ファイル操作テスト
- [ ] OS統合テスト
- [ ] マルチウィンドウテスト

#### プラットフォーム別テスト

- [ ] Windows環境テスト
- [ ] macOS環境テスト
- [ ] Linux環境テスト（該当する場合）

---

## 6. 非機能・受け入れ条件

### 6.1 非機能要求の具体化

| NF ID | 要求 | この機能での具体化 |
|-------|------|-------------------|
| NF-YYYYMMDD-nnn | パフォーマンス | 起動時間3秒以内、メモリ使用量500MB以内 |
| NF-YYYYMMDD-nnn | 互換性 | Windows 10+, macOS 12+, Ubuntu 20.04+ |
| NF-YYYYMMDD-nnn | オフライン動作 | ネットワークなしで全機能利用可能 |

### 6.2 受け入れ条件

#### AC-1: [条件名]

```gherkin
Given [前提条件]
When [操作・アクション]
Then [期待される結果]
```

#### AC-2: [条件名]

```gherkin
Given [前提条件]
When [操作・アクション]
Then [期待される結果]
```

### 6.3 パフォーマンス基準

| メトリクス | 目標値 | 測定方法 |
|-----------|--------|---------|
| 起動時間 | 3秒以内 | 手動計測 |
| メモリ使用量（アイドル） | 300MB以内 | タスクマネージャー |
| メモリ使用量（動作時） | 500MB以内 | タスクマネージャー |
| CPU使用率（アイドル） | 1%以下 | タスクマネージャー |
| ファイル操作応答時間 | 1秒以内 | 手動計測 |

---

## 7. 実装メモ・注意点

### 7.1 適用した設計パターン

- **[パターン名1]**: [適用理由・概要]
- **[パターン名2]**: [適用理由・概要]

### 7.2 関連コードへのリンク

| 種別 | パス |
|------|------|
| メインプロセス | `src/main/[file-name].ts` |
| レンダラープロセス | `src/renderer/[file-name].tsx` |
| ネイティブモジュール | `src/native/[module-name]/` |
| 設定ファイル | `src/config/` |
| テストコード | `tests/[feature-name]/` |

### 7.3 技術的負債・暫定対応

- [ ] [負債1：何が暫定で、どう直すべきか]
- [ ] [負債2]

### 7.4 注意点・申し送り事項

- [注意点1]
- [注意点2]

### 7.5 Desktop固有の考慮事項

#### OS別の挙動差異

| 機能 | Windows | macOS | Linux |
|------|---------|-------|-------|
| [機能1] | [挙動] | [挙動] | [挙動] |
| [機能2] | [挙動] | [挙動] | [挙動] |

#### パッケージング

- **Windows**:
  - 形式: `.exe` (インストーラー), `.zip` (ポータブル)
  - ツール: Electron Builder / Tauri

- **macOS**:
  - 形式: `.dmg`, `.app`
  - 署名: Developer ID Application
  - 公証: Apple Notarization

- **Linux**:
  - 形式: `.deb`, `.rpm`, `.AppImage`
  - ディストリビューション: Ubuntu, Fedora, Arch

#### 自動更新

| 項目 | 仕様 |
|------|------|
| 更新チェック | 起動時 / 定期的 / 手動 |
| 更新方法 | 自動ダウンロード / 手動ダウンロード |
| 更新タイミング | 即時 / 次回起動時 |
| ロールバック | 可能 / 不可 |

---

## 8. インストール・配布

### 8.1 インストーラー

#### Windows

- **インストーラー形式**: NSIS / WiX
- **インストール先**: `C:\Program Files\[app-name]`
- **スタートメニュー**: あり / なし
- **デスクトップショートカット**: あり / なし
- **レジストリ登録**: あり / なし

#### macOS

- **配布形式**: DMG / PKG
- **インストール先**: `/Applications/[app-name].app`
- **Dock登録**: ユーザー選択

#### Linux

- **パッケージ形式**: deb / rpm / AppImage
- **インストール先**: `/opt/[app-name]` または `/usr/local/bin/`
- **デスクトップエントリ**: あり

### 8.2 アンインストール

| OS | アンインストール方法 |
|----|-------------------|
| Windows | コントロールパネル / 設定 > アプリ |
| macOS | アプリケーションフォルダから削除 |
| Linux | パッケージマネージャー / AppImage削除 |

**残存ファイル**:
- 設定ファイル: [削除する / 残す]
- データファイル: [削除する / 残す]

### 8.3 システム要件

| 項目 | 最小要件 | 推奨要件 |
|------|---------|---------|
| OS | Windows 10, macOS 12, Ubuntu 20.04 | Windows 11, macOS 14, Ubuntu 22.04 |
| CPU | 2コア 2GHz | 4コア 3GHz |
| メモリ | 4GB | 8GB |
| ディスク | 500MB | 1GB |
| ディスプレイ | 1280x720 | 1920x1080 |

---

## 9. セキュリティ

### 9.1 セキュリティチェックリスト

- [ ] **ローカルストレージ暗号化**: 機密データの暗号化
- [ ] **通信の暗号化**: HTTPS/TLS使用
- [ ] **コード署名**: アプリの署名
- [ ] **権限管理**: 最小権限の原則
- [ ] **入力検証**: インジェクション対策
- [ ] **依存ライブラリ**: 脆弱性スキャン

### 9.2 OS別セキュリティ

| OS | セキュリティ機能 |
|----|---------------|
| Windows | SmartScreen, UAC対応 |
| macOS | Gatekeeper, Sandboxing, Notarization |
| Linux | AppArmor/SELinux対応 |

---

## 10. ログ・デバッグ

### 10.1 ログ出力

| ログレベル | 出力内容 |
|-----------|---------|
| ERROR | エラー情報 |
| WARN | 警告情報 |
| INFO | 一般情報 |
| DEBUG | デバッグ情報 |

### 10.2 クラッシュレポート

- **収集情報**: スタックトレース、システム情報、ユーザー操作履歴
- **送信方法**: 自動送信 / ユーザー確認後送信
- **プライバシー**: 個人情報の除外
